# VITA-Audio: é«˜æ•ˆå¤§å‹è¯­éŸ³è¯­è¨€æ¨¡å‹çš„å¿«é€Ÿäº¤é”™è·¨æ¨¡æ€ä»¤ç‰Œç”Ÿæˆ

<p align="center">
    <img src="asset/vita-audio_logo.jpg" width="60%" height="60%">
</p>

<font size=7><div align='center' > [[ğŸ“– VITA-Audio è®ºæ–‡](https://arxiv.org/abs/2505.03739)] [[ğŸ¤– æ¨¡å‹æƒé‡](https://huggingface.co/collections/VITA-MLLM/vita-audio-680f036c174441e7cdf02575)]  [[ğŸ’¬ å¾®ä¿¡ç¾¤ (å¾®ä¿¡)](./asset/wechat-group.jpg)]</div></font>

<div align="center">
    <a href="./README_EN.md">ğŸ‡ºğŸ‡¸ English Version</a> | <a href="./README.md">ğŸ‡¨ğŸ‡³ ä¸­æ–‡ç‰ˆæœ¬</a>
</div>

## :fire: æœ€æ–°æ¶ˆæ¯

* **`2025.05.07`** ğŸŒŸ æˆ‘ä»¬å¾ˆè‡ªè±ªåœ°å‘å¸ƒVITA-Audioï¼Œè¿™æ˜¯ä¸€ä¸ªå…·æœ‰å¿«é€ŸéŸ³é¢‘-æ–‡æœ¬ä»¤ç‰Œç”Ÿæˆèƒ½åŠ›çš„ç«¯åˆ°ç«¯å¤§å‹è¯­éŸ³æ¨¡å‹ã€‚

## ğŸ“„ ç›®å½•

- [äº®ç‚¹ç‰¹æ€§](#-äº®ç‚¹ç‰¹æ€§)
- [æ•ˆæœå±•ç¤º](#-æ•ˆæœå±•ç¤º)
- [æ¨¡å‹ä»‹ç»](#-æ¨¡å‹ä»‹ç»)
- [å®éªŒç»“æœ](#-å®éªŒç»“æœ)
- [ç¯å¢ƒè¦æ±‚ä¸å®‰è£…](#-ç¯å¢ƒè¦æ±‚ä¸å®‰è£…)
- [è®­ç»ƒæŒ‡å—](#-è®­ç»ƒæŒ‡å—)
- [æ¨ç†ä½¿ç”¨](#-æ¨ç†ä½¿ç”¨)
- [è¯„ä¼°æµ‹è¯•](#-è¯„ä¼°æµ‹è¯•)

## âœ¨ äº®ç‚¹ç‰¹æ€§

- **ä½å»¶è¿Ÿ**: VITA-Audioæ˜¯ç¬¬ä¸€ä¸ªèƒ½å¤Ÿåœ¨åˆå§‹å‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­ç”ŸæˆéŸ³é¢‘çš„ç«¯åˆ°ç«¯è¯­éŸ³æ¨¡å‹ã€‚é€šè¿‡ä½¿ç”¨32ä¸ªé¢„å¡«å……ä»¤ç‰Œï¼ŒVITA-Audioå°†ç”Ÿæˆç¬¬ä¸€ä¸ªéŸ³é¢‘ä»¤ç‰Œå—æ‰€éœ€çš„æ—¶é—´ä»236æ¯«ç§’å‡å°‘åˆ°ä»…53æ¯«ç§’ã€‚
- **å¿«é€Ÿæ¨ç†**: VITA-Audioåœ¨7Bå‚æ•°è§„æ¨¡ä¸‹å®ç°äº†3-5å€çš„æ¨ç†åŠ é€Ÿã€‚
- **å¼€æºæ•°æ®**: VITA-Audioä»…ä½¿ç”¨**å¼€æºæ•°æ®**è®­ç»ƒï¼ŒåŒ…å«20ä¸‡å°æ—¶çš„å…¬å¼€å¯ç”¨éŸ³é¢‘ã€‚
- **å¼ºå¤§æ€§èƒ½**: VITA-Audioåœ¨ASRã€TTSå’ŒSQAåŸºå‡†æµ‹è¯•ä¸­ï¼Œåœ¨7Bå‚æ•°ä»¥ä¸‹çš„å°–ç«¯æ¨¡å‹ä¸­å–å¾—äº†å…·æœ‰ç«äº‰åŠ›çš„ç»“æœã€‚

## ğŸ“Œ æ•ˆæœå±•ç¤º

### æ¨ç†åŠ é€Ÿ
ä¸åŒæ¨ç†æ¨¡å¼ä¸‹çš„æ¨¡å‹æ¨ç†é€Ÿåº¦ã€‚

<p align="center">
  <img src="./asset/qa_speed.gif" alt="é—®ç­”é€Ÿåº¦æ¼”ç¤º" width="48%" style="display: inline-block; margin-right: 2%;">
  <img src="./asset/tts_speed.gif" alt="TTSé€Ÿåº¦æ¼”ç¤º" width="48%" style="display: inline-block;">
</p>

### æµå¼æ¨ç†ä¸­ç”Ÿæˆç¬¬ä¸€ä¸ªéŸ³é¢‘æ®µçš„æ—¶é—´
<div align="center">
  <img width="400" alt="ç¬¬ä¸€ä¸ªéŸ³é¢‘ç”Ÿæˆæ—¶é—´" src="https://github.com/user-attachments/assets/165f943e-ac53-443f-abba-e5eb1e0c0f40" />
</div>

### ç”ŸæˆéŸ³é¢‘æ¡ˆä¾‹

> æ‰“å—è¾¹æ¥äº†ä¸ªå“‘å·´ï¼Œè…°é‡Œåˆ«äº†ä¸ªå–‡å­ï¼›æ‰“åŒ—è¾¹æ¥äº†ä¸ªå–‡å˜›ï¼Œæ‰‹é‡Œæäº†ä¸ªç­çŠ¸ã€‚  
> æç€ç­çŠ¸çš„å–‡å˜›è¦æ‹¿ç­çŠ¸æ¢åˆ«ç€å–‡å­çš„å“‘å·´çš„å–‡å­ï¼›åˆ«ç€å–‡å­çš„å“‘å·´ä¸æ„¿æ‹¿å–‡å­æ¢æç€ç­ç›çš„å–‡å˜›çš„ç­çŠ¸ã€‚  
> ä¸çŸ¥æ˜¯åˆ«ç€å–‡å­çš„å“‘å·´æ‰“äº†æç€ç­ç›çš„å–‡å˜›ä¸€å–‡å­ï¼›è¿˜æ˜¯æç€ç­ç›çš„å–‡å˜›æ‰“äº†åˆ«ç€å–‡å­çš„å“‘å·´ä¸€ç­ç›ã€‚  
> å–‡å˜›å›å®¶ç‚–ç­çŠ¸ï¼›å“‘å·´å˜€å˜€å“’å“’å¹å–‡å­ã€‚

https://github.com/user-attachments/assets/38da791f-5d72-4d9c-a9b2-cec97c2f2b2b

---

> To be or not to be--to live intensely and richly,
> merely to exist, that depends on ourselves. Let widen and intensify our relations.   
> While we live, let live!  

https://github.com/user-attachments/assets/fd478065-4041-42bd-9f17-7935b2285799

---

> The hair has been so little, don't think about it, go to bed early, for your hair. Good night!

https://github.com/user-attachments/assets/4cfe4742-e237-42bd-9f17-7935b2285799

---
> ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³ï¼Œ
> ä¸€è¡Œç™½é¹­ä¸Šé’å¤©ã€‚  
> çª—å«è¥¿å²­åƒç§‹é›ªï¼Œ
> é—¨æ³Šä¸œå´ä¸‡é‡Œèˆ¹ã€‚

https://github.com/user-attachments/assets/382620ee-bb2a-488e-9e00-71afd2342b56

## :label: å¾…åŠäº‹é¡¹

- [x] å‘å¸ƒè®­ç»ƒä»£ç å’Œæ¨ç†ä»£ç 
- [x] å‘å¸ƒæ£€æŸ¥ç‚¹æƒé‡
- [x] å‘å¸ƒVITA-Audio-Plus
- [ ] å‘å¸ƒæ¸…ç†åçš„å¼€æºæ•°æ®JSONå’ŒéŸ³é¢‘

## ğŸ”” æ¨¡å‹ä»‹ç»

| æ¨¡å‹                   | LLMå¤§å° | Huggingfaceæƒé‡                                           |
|-------------------------|----------|---------------------------------------------------------------|
| VITA-Audio-Boost        | 7B       | https://huggingface.co/VITA-MLLM/VITA-Audio-Boost             |
| VITA-Audio-Balance      | 7B       | https://huggingface.co/VITA-MLLM/VITA-Audio-Balance           |
| VITA-Audio-Plus-Vanilla | 7B       | https://huggingface.co/VITA-MLLM/VITA-Audio-Plus-Vanilla      |
| VITA-Audio-Plus-Boost   | 7B       | https://huggingface.co/VITA-MLLM/VITA-Audio-Plus-Boost        |

## ğŸ“ˆ å®éªŒç»“æœ

- **è¯­éŸ³é—®ç­”å¯¹æ¯”**

![Clipboard_Screenshot_1746531780](https://github.com/user-attachments/assets/3adcad15-0333-4b92-be49-5a0ace308f3f)

- **æ–‡æœ¬è½¬è¯­éŸ³å¯¹æ¯”**

![image](https://github.com/user-attachments/assets/09cf8fd3-d7a5-4b77-be49-5a0ace308f3f)

- **è‡ªåŠ¨è¯­éŸ³è¯†åˆ«å¯¹æ¯”**

![Clipboard_Screenshot_1746532039](https://github.com/user-attachments/assets/d950cae0-c065-4da9-b37a-a471d28158a0)

![Clipboard_Screenshot_1746532022](https://github.com/user-attachments/assets/929f45cd-693a-4ff6-af73-ceec6e875706)

- **æ¨ç†åŠ é€Ÿæ•ˆæœ**

![Clipboard_Screenshot_1746532167](https://github.com/user-attachments/assets/ad8b9e90-cd3c-4968-8653-998811a50006)

![Image](https://github.com/user-attachments/assets/4aa5db8c-362d-4152-8090-92292b9a84c0)

## ğŸ“” ç¯å¢ƒè¦æ±‚ä¸å®‰è£…

### å‡†å¤‡ç¯å¢ƒ
```bash
docker pull shenyunhang/pytorch:24.11-py3_2024-1224
```

### è·å–ä»£ç 
```bash
git clone https://github.com/VITA-MLLM/VITA-Audio.git
cd VITA-Audio
git submodule update --init --recursive
pip install -r requirements_ds_gpu.txt
pip install -e .
```

### å‡†å¤‡é¢„è®­ç»ƒæƒé‡

#### LLMæ¨¡å‹

- ä» https://huggingface.co/Qwen/Qwen2.5-7B-Instruct ä¸‹è½½LLMæ¨¡å‹
- å°†å…¶æ”¾å…¥ `../models/Qwen/Qwen2.5-7B-Instruct/` ç›®å½•

#### éŸ³é¢‘ç¼–ç å™¨å’ŒéŸ³é¢‘è§£ç å™¨

- ä» https://huggingface.co/THUDM/glm-4-voice-tokenizer ä¸‹è½½éŸ³é¢‘ç¼–ç å™¨
- å°†å…¶æ”¾å…¥ `../models/THUDM/glm-4-voice-tokenizer` ç›®å½•

- ä» https://huggingface.co/THUDM/glm-4-voice-decoder ä¸‹è½½éŸ³é¢‘è§£ç å™¨
- å°†å…¶æ”¾å…¥ `../models/THUDM/glm-4-voice-decoder` ç›®å½•

### æ•°æ®æ ¼å¼

#### **è¯­éŸ³é—®ç­”æ•°æ®æ ¼å¼**

```jsonc
{
  "messages": [
    {
      "content": "<|audio|>",
      "role": "user"
    },
    {
      "content": "å¥½çš„ï¼Œè¿™æ ·æ’åˆ—æ›´åˆç†ï¼šè¿™äº›ç”Ÿç‰©åºŸå¼ƒç‰©å¦‚é¸¡è›‹å£³ã€è›¤å£³ã€è´»è´å£³æ¯”å…¶ä»–å·¥ä¸šåºŸæ¸£æ›´æœ‰ä»·å€¼ã€‚ç ”ç©¶è¡¨æ˜ï¼Œå®ƒä»¬åœ¨èƒ½æºã€ææ–™ã€ç¯å¢ƒä¿æŠ¤ç­‰é¢†åŸŸæœ‰å¹¿æ³›åº”ç”¨ã€‚é«˜æ•ˆåˆ©ç”¨è´å£³èƒ½æé«˜èµ„æºåˆ©ç”¨æ•ˆç‡ï¼Œå‡å°‘åºŸå¼ƒç‰©ï¼Œå‡è½»ç¯å¢ƒè´Ÿæ‹…ã€‚ç‰¹åˆ«æ˜¯åœ¨è¿™äº›é¢†åŸŸä¸­ï¼Œé¸¡è›‹å£³å› ä¸ºå«æœ‰ä¸°å¯Œçš„é’™å…ƒç´ ï¼Œè¢«ç”¨äºåˆ¶é€ åŒ»è¯å“å’Œè‚¥æ–™ã€‚\n<|audio|>",
      "role": "assistant"
    }
  ],
  "audios": [
    "datasets/VITA-MLLM/AudioQA-1M/QA_1450K_question_tar/question_shuf_part_8/wav/000000200014510ac1fd776006fc66b36f7f3cda76_question.wav",
    "datasets/VITA-MLLM/AudioQA-1M/QA_1450K_answer_part1_tar/answer_part1_shuf_part_3/wav/000000200114510ac1fd776006fc66b36f7f3cda76_F10.wav"
  ]
}
```

#### **ASRæ•°æ®æ ¼å¼**

```jsonc
{
  "messages": [
    {
      "content": "Convert the speech to text.\n<|audio|>",
      "role": "user"
    },
    {
      "content": "æ²¡æœ‰è·Ÿå¤§å®¶è¯´æ˜¯åœ¨åšä»€ä¹ˆ",
      "role": "assistant"
    }
  ],
  "audios": [
    "datasets/wenet-e2e/wenetspeech/data/cuts_L_fixed.00000000/X00/X0000016296_135343932_S00019.wav"
  ]
}
```

#### **TTSæ•°æ®æ ¼å¼**

```jsonc
{
  "messages": [
    {
      "content": "Convert the text to speech.\né‚£æˆ‘æƒ…æ„¿æ— è¯å¯æ•‘ã€‚",
      "role": "user"
    },
    {
      "content": "<|audio|>",
      "role": "assistant"
    }
  ],
  "audios": [
    "datasets/Wenetspeech4TTS/WenetSpeech4TTS/Premium/WenetSpeech4TTS_Premium_9/wavs/X0000001735_50639692_S00035.wav"
  ]
}
```

## ğŸ² è®­ç»ƒæŒ‡å—

ä»¥ä¸‹æ•™ç¨‹å°†ä»¥ `VITA-Audio-Boost` ä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚

- è¦è®­ç»ƒ `VITA-Audio-Balance` å’Œå…¶ä»–å˜ä½“ï¼Œä½ åº”è¯¥ä¿®æ”¹ `text-audio-interval-ratio` å‚æ•°ã€‚

  VITA-Audio-Boost:
  ```bash
  --text-audio-interval-ratio 1 10 4 10 \
  ```

  VITA-Audio-Balance:
  ```bash
  --text-audio-interval-ratio 1 4 3 8 4 10 \
  ```

- è¦è®­ç»ƒ `VITA-Audio-Plus-*`ï¼Œä½ åº”è¯¥ä½¿ç”¨ç±»ä¼¼ `scripts/deepspeed/sts_qwen25/finetune_sensevoice_glm4voice...` çš„è„šæœ¬

### ç¬¬ä¸€é˜¶æ®µ (éŸ³é¢‘-æ–‡æœ¬å¯¹é½)

```bash
bash scripts/deepspeed/sts_qwen25/finetune_glm4voice_stage1.sh 8192 `date +'%Y%m%d_%H%M%S'`
```

ä¸Šè¿°è„šæœ¬å¯èƒ½éœ€è¦ä¸€äº›è°ƒæ•´ï¼š

- å°† `ROOT_PATH` è®¾ç½®ä¸ºä½ çš„ä»£ç æ ¹ç›®å½•
- å°† `LOCAL_ROOT_PATH` è®¾ç½®ä¸ºä¸´æ—¶ä»£ç æ ¹ç›®å½•
- æ ¹æ®ä½ çš„ç¯å¢ƒä¿®æ”¹å…¶ä»–å˜é‡

### ç¬¬äºŒé˜¶æ®µ (å•MCTPæ¨¡å—è®­ç»ƒ)

```bash
bash scripts/deepspeed/sts_qwen25/finetune_glm4voice_mtp1_stage1.sh 8192 `date +'%Y%m%d_%H%M%S'`
```

ä¸Šè¿°è„šæœ¬å¯èƒ½éœ€è¦ä¸€äº›è°ƒæ•´ï¼š

- å°† `ROOT_PATH` è®¾ç½®ä¸ºä½ çš„ä»£ç æ ¹ç›®å½•
- å°† `LOCAL_ROOT_PATH` è®¾ç½®ä¸ºä¸´æ—¶ä»£ç æ ¹ç›®å½•
- å°† `MODEL_NAME_OR_PATH` è®¾ç½®ä¸ºç¬¬ä¸€é˜¶æ®µè®­ç»ƒçš„æ¨¡å‹è·¯å¾„
- æ ¹æ®ä½ çš„ç¯å¢ƒä¿®æ”¹å…¶ä»–å˜é‡

### ç¬¬ä¸‰é˜¶æ®µ (å¤šMCTPæ¨¡å—è®­ç»ƒ)

```bash
bash scripts/deepspeed/sts_qwen25/finetune_glm4voice_mtp10_stage1.sh 8192 `date +'%Y%m%d_%H%M%S'`
```

ä¸Šè¿°è„šæœ¬å¯èƒ½éœ€è¦ä¸€äº›è°ƒæ•´ï¼š

- å°† `ROOT_PATH` è®¾ç½®ä¸ºä½ çš„ä»£ç æ ¹ç›®å½•
- å°† `LOCAL_ROOT_PATH` è®¾ç½®ä¸ºä¸´æ—¶ä»£ç æ ¹ç›®å½•
- å°† `MODEL_NAME_OR_PATH` è®¾ç½®ä¸ºç¬¬äºŒé˜¶æ®µè®­ç»ƒçš„æ¨¡å‹è·¯å¾„
- æ ¹æ®ä½ çš„ç¯å¢ƒä¿®æ”¹å…¶ä»–å˜é‡

### ç¬¬å››é˜¶æ®µ (ç›‘ç£å¾®è°ƒ)

```bash
bash scripts/deepspeed/sts_qwen25/finetune_glm4voice_mtp10_stage2.sh 2048 `date +'%Y%m%d_%H%M%S'`
```

ä¸Šè¿°è„šæœ¬å¯èƒ½éœ€è¦ä¸€äº›è°ƒæ•´ï¼š

- å°† `ROOT_PATH` è®¾ç½®ä¸ºä½ çš„ä»£ç æ ¹ç›®å½•
- å°† `LOCAL_ROOT_PATH` è®¾ç½®ä¸ºä¸´æ—¶ä»£ç æ ¹ç›®å½•
- å°† `MODEL_NAME_OR_PATH` è®¾ç½®ä¸ºç¬¬ä¸‰é˜¶æ®µè®­ç»ƒçš„æ¨¡å‹è·¯å¾„
- æ ¹æ®ä½ çš„ç¯å¢ƒä¿®æ”¹å…¶ä»–å˜é‡

## ğŸ“ æ¨ç†ä½¿ç”¨

è¿™é‡Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªç®€å•çš„æ¨ç†è„šæœ¬ã€‚

å®ƒåŒ…å«äº†è¯­éŸ³è½¬è¯­éŸ³ã€ASRå’ŒTTSä»»åŠ¡çš„ç¤ºä¾‹ï¼Œä»¥åŠæµå¼å’Œéæµå¼æ¨ç†é€Ÿåº¦æµ‹è¯•ã€‚

```bash
python tools/inference_sts.py
```

- å°† `model_name_or_path` è®¾ç½®ä¸ºVITA-Audioæƒé‡è·¯å¾„
- å°† `audio_tokenizer_path` è®¾ç½®ä¸ºéŸ³é¢‘ç¼–ç å™¨è·¯å¾„
- å°† `flow_path` è®¾ç½®ä¸ºéŸ³é¢‘è§£ç å™¨è·¯å¾„

## ğŸ” è¯„ä¼°æµ‹è¯•

è¯„ä¼°SQAã€ASRå’ŒTTSåŸºå‡†æµ‹è¯•
```bash
bash scripts/deepspeed/evaluate_sts.sh
```

## &#x1F4E3; å£°æ˜

**VITA-Audioåœ¨å¤§è§„æ¨¡å¼€æºè¯­æ–™åº“ä¸Šè®­ç»ƒï¼Œå…¶è¾“å‡ºå…·æœ‰éšæœºæ€§ã€‚VITA-Audioç”Ÿæˆçš„ä»»ä½•å†…å®¹éƒ½ä¸ä»£è¡¨æ¨¡å‹å¼€å‘è€…çš„è§‚ç‚¹ã€‚æˆ‘ä»¬å¯¹å› ä½¿ç”¨ã€æ»¥ç”¨å’Œä¼ æ’­VITA-Audioè€Œäº§ç”Ÿçš„ä»»ä½•é—®é¢˜ä¸æ‰¿æ‹…è´£ä»»ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºèˆ†è®ºé£é™©å’Œæ•°æ®å®‰å…¨é—®é¢˜ã€‚**

## :black_nib: å¼•ç”¨

å¦‚æœä½ å‘ç°æˆ‘ä»¬çš„å·¥ä½œå¯¹ä½ çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘å¼•ç”¨ä»¥ä¸‹BibTeXæ¡ç›®ã€‚

```bibtex
@misc{,
      title={VITA-Audio: Fast Interleaved Cross-Modal Token Generation for Efficient Large Speech-Language Model}, 
      author={Zuwei Long and Yunhang Shen and Chaoyou Fu and Heting Gao and Lijiang Li and Peixian Chen and Mengdan Zhang and Hang Shao and Jian Li and Jinlong Peng and Haoyu Cao and Ke Li and Rongrong Ji and Xing Sun},
      year={2025},
      eprint={2505.03739},
      archivePrefix={arXiv},
      primaryClass={cs.CL},
      url={https://arxiv.org/abs/2505.03739}, 
}
```
